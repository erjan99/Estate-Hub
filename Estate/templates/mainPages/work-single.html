{% extends 'mainPages/base.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="en">

<!-- Start Banner Hero -->
{% block content %}
<div id="work_single_banner" class="bg-light w-100">
    <div class="container-fluid text-light d-flex justify-content-center align-items-center border-0 rounded-0 p-0 py-5">
        <div class="banner-content col-lg-8 m-lg-auto text-center py-5 px-3">
            <h1 class="banner-heading h2 pb-5 typo-space-line-center">Digital Marketing</h1>
            <h3 class="h4 pb-2 light-300">Voluptatem accusantium doloremque</h3>
            <p class="banner-footer light-300">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit,
                sed do eiusmod tempor incididunt ut labore et dolore magna
                aliqua. Integer ut ipsum eu libero venenatis euismod.
            </p>
        </div>
    </div>
</div>
<!-- End Banner Hero -->

<!-- Start Work Sigle -->
<section class="container py-5">

    <div class="row pt-5">
        <div class="worksingle-content col-lg-8 m-auto text-left justify-content-center">
            <h2 class="worksingle-heading h3 pb-3 light-300 typo-space-line">{{estate.name}}</h2>
        </div>
    </div><!-- End Blog Cover -->

    <div class="row justify-content-center pb-4">
        <div class="col-lg-8">
            <div id="templatemo-slide-link-target" class="card mb-3">
                <img class="img-fluid border rounded" src="{{ estate.image.url }}" alt="Card image cap">
            </div>
            <div class="worksingle-slide-footer row">

                <!--Start Controls-->
                <div class="col-1 align-self-center">
                    <a href="#multi-item-example" role="button" data-bs-slide="prev">
                        <i class='bx bxs-chevron-left bx-sm text-dark'></i>
                    </a>
                </div>
                <!--End Controls-->

                <!--Start Carousel Wrapper-->
                <div id="multi-item-example" class="col-10 carousel slide" data-bs-ride="carousel">
                    <!--Start Slides-->
                    <div class="carousel-inner" role="listbox">

                        <!--First slide-->
                        <div class="carousel-item active">
                            <div class="row">
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-06.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-06-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-05.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-05-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-04.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-04-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-03.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-03-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-01.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-01-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!--/.First slide-->

                        <!--Second slide-->
                        <div class="carousel-item">
                            <div class="row">
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-01.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-01-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-03.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-03-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-02.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-02-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-01.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-01-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-06.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-06-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!--/.Second slide-->

                        <!--Second slide-->
                        <div class="carousel-item">
                            <div class="row">
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-01.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-01-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-03.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-03-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-02.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-02-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-01.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-01-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                                <div class="col">
                                    <a class="templatemo-slide-link" href="{% static 'assets/img/work-slide-06.jpg' %}">
                                        <img class="img-fluid border rounded" src="{% static 'assets/img/work-slide-06-small.jpg' %}" alt="Product Image">
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!--/.Second slide-->

                    </div>
                    <!--End Slides-->
                </div>
                <!--End Carousel Wrapper-->

                <!--Start Controls-->
                <div class="col-1 align-self-center text-end">
                    <a href="#multi-item-example" role="button" data-bs-slide="next">
                        <i class='bx bxs-chevron-right bx-sm text-dark'></i>
                    </a>
                </div>
                <!--End Controls-->

            </div>
        </div>
    </div><!-- End Slider -->




    <div class="row">
        <div class="col-md-8 m-auto text-left justify-content-center">
            <p class="fs-5 py-4 ps-4 border border-5 border-top-0 border-end-0 border-bottom-0 border-start"
               style="max-width: 100%; word-wrap: break-word; overflow-wrap: break-word; white-space: normal;">
                <i>
                    {{ estate.description }}
                </i>
            </p>
        </div>
    </div>



    <div class="row justify-content-center">
        <div class="col-lg-8 pt-4 pb-4">
            <video class="w-100 rounded shadow" controls>
                <source src="{{ estate.video.url }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </div><!-- End Video -->

    <div class="worksingle-content col-lg-8 m-auto text-left justify-content-center">
        <h2 class="worksingle-heading h3 pb-3 light-300 typo-space-line">{{ estate.name }}</h2>

        <ul class="list-group list-group-flush mb-4">
            <li class="list-group-item"><strong>Price:</strong> {{ estate.price }}$</li>
            <li class="list-group-item"><strong>Area:</strong> {{ estate.area }} mÂ²</li>
            <li class="list-group-item"><strong>Category:</strong> {{ estate.category.name }}</li>
            <li class="list-group-item"><strong>City:</strong> {{ estate.city }}</li>
            <li class="list-group-item"><strong>District:</strong> {{ estate.district }}</li>
            <li class="list-group-item"><strong>Geolocation:</strong> {{ estate.geo }}</li>
            <li class="list-group-item"><strong>Created at:</strong> {{ estate.created_at|date:"F d, Y" }}</li>
            <li class="list-group-item">
                <strong>Status:</strong>
                {% if estate.is_active %}
                <span class="text-success">Active</span>
                {% else %}
                <span class="text-danger">Inactive</span>
                {% endif %}
            </li>
        </ul>
    </div>



    <!-- End Work Sigle -->

    <!-- Start Comment -->
    <div class="row justify-content-center">
        <div class="worksingle-comment-heading col-8 m-auto pb-3">
            <h4 class="h5">Comments</h4>
        </div>
    </div>
    {% if feedbacks %}
    {% for feedback in feedbacks %}
    <div class="row pb-4" id="feedback-{{ feedback.id }}">
        <div class="col-md-8 mx-auto">
            <div class="card shadow-sm border-0 position-relative">
                {% if feedback.user == request.user %}
                <form method="post" action="{% url 'delete_feedback' feedback.id %}" class="position-absolute top-0 end-0 m-2">
                    {% csrf_token %}
                    <a href="{% url 'delete_feedback' feedback.id %}"><button type="submit" class="btn-close" aria-label="Close"></button></a>
                </form>
                {% endif %}

                <!-- COMMENT BODY -->
                <div class="card-body d-flex align-items-start">
                    <!-- Avatar -->
                    <div class="me-3">
                        {% if request.user.avatar %}
                        <img src="{{ request.user.avatar }}" class="rounded-circle border" style="width: 50px; height: 50px;" alt="User Avatar">
                        {% else %}
                        <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" class="rounded-circle border" style="width: 50px; height: 50px;" alt="Default Avatar">
                        {% endif %}
                    </div>

                    <!-- Content -->
                    <div class="flex-grow-1">
                        <div class="d-flex justify-content-between align-items-start">
                            <div>
                                <h6 class="mb-0">{{ feedback.user.username }}</h6>
                                <small class="text-muted">{{ feedback.created_at }}</small>
                            </div>
                            {% if feedback.user != request.user %}
                            <a href="#" class="text-decoration-none text-secondary small">
                                <i class="bx bxs-share me-1"></i>Reply
                            </a>
                            {% endif %}
                        </div>
                        <div class="mt-3 p-3 bg-light rounded border">
                            {{ feedback.comment }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="text-center text-muted py-4">
        <p>No feedback yet. Be the first to comment!</p>
    </div>
    {% endif %}




    <div class="row pb-4">
        <div class="worksingle-comment-footer col-lg-8 m-auto">
            <h4 class="h5">Leave Comment</h4>
            <form class="col-md-12 m-auto" method="POST" action="{% url 'user_feedback' estate.id %}" role="form">
                {% csrf_token %}
                <div class="form-group">
                    <textarea class="form-control form-control-lg light-300" id="inputmessage" name="inputmessage" placeholder="Your Comment" rows="5"></textarea>
                </div>

                <div class="form-row pt-2">
                    <div class="col-md-12 col-10 text-end">
                        <button type="submit" class="btn btn-secondary text-white px-md-4 px-2 py-md-3 py-1 radius-0 light-300">Send</button>
                    </div>
                </div>
            </form>
        </div>
    </div><!-- End Comment Form -->


</section>
<!-- End Work Sigle -->

<!-- Start Related Post -->
<section class="container py-5">
    {% if similar_estates %}
    <div class="row">
        {% for estate in similar_estates %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="position-relative">
                    {% if estate.image %}
                    <img src="{{ estate.image.url }}" class="card-img-top" alt="{{ estate.title }}">
                    {% else %}
                    <img src="{% static 'default.jpg' %}" class="card-img-top" alt="Default Image">
                    {% endif %}
                    <form method="post" action="{% url 'user_favourite_estates' estate.id %}" style="position: absolute; top: 10px; right: 15px;">
                        {% csrf_token %}
                        <button
                                type="submit"
                                class="btn-favourite {% if estate.id in liked_estates %}active{% endif %} p-0 border-0"
                                style="background: none;">
                            {% if estate.id in liked_estates %}
                            <i class='bx bxs-heart bx-sm' style="color: #ff3366;"></i>
                            {% else %}
                            <i class='bx bx-heart bx-sm' style="color: #ff3366;"></i>
                            {% endif %}
                        </button>
                    </form>
                </div>
                <div class="card-body">
                    <h5 class="card-title text-primary">{{ estate.name }}</h5>
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted"><i class='bx bx-map'></i> {{ estate.location }}</span>
                        <span class="badge bg-primary rounded-pill">{{ estate.category.name }}</span>
                    </div>
                    <p class="card-text">{{ estate.description|truncatechars:100 }}</p>
                </div>
                <div class="card-footer bg-white border-top-0">
                    <div class="d-flex justify-content-between align-items-center">
                        <strong class="text-primary">${{ estate.price|floatformat:0 }}</strong>
                        <a href="{% url 'detail_view' estate.id %}" class="btn btn-outline-primary btn-sm">View Details</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class='bx bx-heart bx-lg text-secondary mb-3'></i>
        <h3 class="text-secondary">There is no estates for sale yet</h3>
        <p class="text-muted mb-4">Try to browse a bit later</p>
        <a href="{% url 'index' %}" class="btn btn-primary">Home</a>
    </div>
    {% endif %}
</section>


</html>
{% endblock %}


