{% extends 'mainPages/base.html' %}
{% load static %}

{% block content %}
<!-- Start Banner Hero -->

<style>
    .filter-btn:hover {
        background-color: white;
        color: #000 !important; /* make text black for contrast */
        transition: background-color 0.3s ease, color 0.3s ease;
    }


</style>

<div class="banner-wrapper bg-light">
    <div id="index_banner" class="banner-vertical-center-index container-fluid pt-5">

        <!-- Start slider -->
        <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
            <ol class="carousel-indicators">
                <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"></li>
                <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"></li>
                <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">

                    <div class="py-5 row d-flex align-items-center">
                        <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                            <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-5 mx-0 px-0 light-300 typo-space-line">
                                Develop <strong>Strategies</strong> for
                                <br>your business
                            </h1>
                            <p class="banner-body text-muted py-3 mx-0 px-0">
                                Purple Buzz is a corporate HTML template with Bootstrap 5 Beta 1. This CSS template is 100% free to download provided by <a rel="nofollow" href="https://templatemo.com/page/1" target="_parent">TemplateMo</a>. Total 6 HTML pages included in this template. Icon fonts by <a rel="nofollow" href="https://boxicons.com/" target="_blank">Boxicons</a>. Photos are from <a rel="nofollow" href="https://unsplash.com/" target="_blank">Unsplash</a> and <a rel="nofollow" href="https://icons8.com/" target="_blank">Icons 8</a>.
                            </p>
                            <a class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4" href="#" role="button">Get Started</a>
                        </div>
                    </div>

                </div>
                <div class="carousel-item">

                    <div class="py-5 row d-flex align-items-center">
                        <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                            <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-3 mx-0 px-0 light-300">
                                HTML CSS Template with Bootstrap 5 Beta 1
                            </h1>
                            <p class="banner-body text-muted py-3">
                                You are not allowed to re-distribute this Purple Buzz HTML template as a downloadable ZIP file on any kind of Free CSS collection websites. This is strongly prohibited. Please contact TemplateMo for more information.
                            </p>
                            <a class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4" href="#" role="button">Get Started</a>
                        </div>
                    </div>

                </div>
                <div class="carousel-item">

                    <div class="py-5 row d-flex align-items-center">
                        <div class="banner-content col-lg-8 col-8 offset-2 m-lg-auto text-left py-5 pb-5">
                            <h1 class="banner-heading h1 text-secondary display-3 mb-0 pb-3 mx-0 px-0 light-300">
                                Cupidatat non proident, sunt in culpa qui officia
                            </h1>
                            <p class="banner-body text-muted py-3">
                                Ut enim ad minim veniam, quis nostrud exercitation ullamco
                                laboris nisi ut aliquip ex ea commodo consequat. Duis aute
                                irure dolor in reprehenderit in voluptate velit esse cillum
                                dolore eu fugiat nulla pariatur. Excepteur sint occaecat.
                            </p>
                            <a class="banner-button btn rounded-pill btn-outline-primary btn-lg px-4" href="#" role="button">Get Started</a>
                        </div>
                    </div>

                </div>
            </div>
            <a class="carousel-control-prev text-decoration-none" href="#carouselExampleIndicators" role="button" data-bs-slide="prev">
                <i class='bx bx-chevron-left'></i>
                <span class="visually-hidden">Previous</span>
            </a>
            <a class="carousel-control-next text-decoration-none" href="#carouselExampleIndicators" role="button" data-bs-slide="next">
                <i class='bx bx-chevron-right'></i>
                <span class="visually-hidden">Next</span>
            </a>
        </div>
        <!-- End slider -->

    </div>
</div>
<!-- End Banner Hero -->



<!-- Start Service -->
<section class="service-wrapper py-3">
    <div class="container-fluid pb-3 text-white text-center" style="background-color: #6165e8;">
        <div class="row justify-content-center">
            <div class="col-12 py-3">
                <h2 class="h2 semi-bold-600">Estate Hub</h2>
            </div>
            <div class="col-12">
                <h2 class="h3 d-inline-block typo-space-line">
                    Sell, buy and rent with us
                    <i class='bx bx-gift align-middle ms-2'></i>
                </h2>
            </div>
            <div class="col-12 col-md-8 col-lg-6">
                <p class="px-2">
                    List your home for sale or rent with ease. Browse our wide selection
                    of properties to find the perfect place to call home. Just scroll down, explore
                    , and enjoy the experience! ðŸ˜„
                </p>
            </div>
        </div>
    </div>
</section>



<section class="py-5 mb-5">
    <div class="container">
        <div class="recent-work-header row text-center pb-5">
            <h2 class="col-md-6 m-auto h2 semi-bold-600 py-5">Categories</h2>
        </div>
        <div class="row gy-5 g-lg-5 mb-4">
            {% for category in parent_categories %}
            <div class="col-md-4 mb-3">
                <a href="{% url 'filtered_cards' category.id %}" class="recent-work card border-0 shadow-lg overflow-hidden">
                    {% if category.image %}
                    <img class="recent-work-img card-img" src="{{ category.image.url }}" alt="Card image" style="height: 350px; object-fit: cover;">
                    {% else %}
                    <div class="bg-secondary" style="height: 350px; display: flex; align-items: center; justify-content: center;">
                        <span class="text-white">No Image</span>
                    </div>
                    {% endif %}
                    <div class="recent-work-vertical card-img-overlay d-flex align-items-end">
                        <div class="recent-work-content text-start mb-3 ml-3 text-dark">
                            <h3 class="card-title light-300">{{ category.name }}</h3>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>


<div class="service-tag py-5 bg-secondary">
    <div class="col-md-12">
        <ul class="nav d-flex justify-content-center">
            {% for category in parent_categories %}
            <li class="nav-item mx-lg-4">
                <a class="filter-btn nav-link btn-outline-primary rounded-pill text-light px-4 light-300"
                   href="{% url 'filtered_cards' category.id %}">
                   {{ category.name }}
                </a>
            </li>
            {% endfor %}
        </ul>
    </div>
</div>

<section class="container py-5">
    {% if estates %}
    <div class="row">
        {% for estate in estates %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="position-relative">
                    {% if estate.image %}
                    <img src="{{ estate.image.url }}" class="card-img-top" alt="{{ estate.title }}">
                    {% else %}
                    <img src="{{ estate.image.url }}" class="card-img-top" alt="Default Image">
                    {% endif %}
                    <form method="post" action="{% url 'user_favourite_estates' estate.id %}" style="position: absolute; top: 10px; right: 15px;">
                        {% csrf_token %}
                        <button
                            type="submit"
                            class="btn-favourite {% if estate.id in liked_estates %}active{% endif %} p-0 border-0"
                            style="background: none;">
                            {% if estate.id in liked_estates %}
                                <i class='bx bxs-heart bx-sm' style="color: #ff3366; filter: drop-shadow(0px 0px 2px rgba(0,0,0,0.3));"></i>
                            {% else %}
                                <i class='bx bx-heart bx-sm' style="color: #ffffff; filter: drop-shadow(0px 0px 2px rgba(0,0,0,0.5));"></i>
                            {% endif %}
                        </button>
                    </form>
                </div>
                <div class="card-body">
                    <h5 class="card-title text-primary">{{ estate.title }}</h5>
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-muted"><i class='bx bx-map'></i> {{ estate.location }}</span>
                        <span class="badge bg-primary rounded-pill">{{ estate.category.name }}</span>
                    </div>
                    <p class="card-text">{{ estate.description|truncatechars:100 }}</p>
                </div>
                <div class="card-footer bg-white border-top-0">
                    <div class="d-flex justify-content-between align-items-center">
                        <strong class="text-primary">${{ estate.price|floatformat:0 }}</strong>
                        <a href="{% url 'detail_view' estate.id %}" class="btn btn-outline-primary btn-sm">View Details</a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class='bx bx-heart bx-lg text-secondary mb-3'></i>
        <h3 class="text-secondary">There is no estates for sale yet</h3>
        <p class="text-muted mb-4">Try to browse a bit later</p>
        <a href="{% url 'index' %}" class="btn btn-primary">Home</a>
    </div>
    {% endif %}
</section>
<!-- Start Recent Work -->


{% endblock  %}

{% block extra_css %}
<style>
    .btn-favourite {
        background: none;
        border: none;
        cursor: pointer;
        padding: 5px;
        transition: transform 0.2s;
        z-index: 10;
    }

    .btn-favourite:hover {
        transform: scale(1.2);
    }

    .card {
        transition: transform 0.3s;
        border-radius: 12px;
        overflow: hidden;
    }

    .card:hover {
        transform: translateY(-5px);
    }

    .card-img-top {
        height: 200px;
        object-fit: cover;
    }

    .badge {
        font-weight: 500;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    function toggleFavourite(event, estateId) {
        event.preventDefault();
        window.location.href = `/favourite/${estateId}/`;
    }
</script>
{% endblock %}
